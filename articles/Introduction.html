<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction • recolorize</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="recolorize">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">recolorize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/step00_prep.html">Step 0: Image acquisition and preparation</a>
    </li>
    <li>
      <a href="../articles/step01_loading.html">Step 1: Loading &amp; processing images</a>
    </li>
    <li>
      <a href="../articles/step02_initial_cluster.html">Step 2: Initial clustering</a>
    </li>
    <li>
      <a href="../articles/step03_refinement.html">Step 3: Refinement</a>
    </li>
    <li>
      <a href="../articles/step04_manual_tweak.html">Step 4: Tweaks &amp; edits</a>
    </li>
    <li>
      <a href="../articles/step05_visualization_export.html">Step 5: Exporting &amp; visualizing output</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction</h1>
            
      
      
      <div class="hidden name"><code>Introduction.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="recolorize-color-based-image-segmentation-for-people-with-other-things-to-do">
<code>recolorize</code>: color-based image segmentation (for people with other things to do)<a class="anchor" aria-label="anchor" href="#recolorize-color-based-image-segmentation-for-people-with-other-things-to-do"></a>
</h2>
<ul>
<li>Introduction</li>
<li>
<a href="step00_prep.html">Step 0: Image acquisition and preparation</a><br>
</li>
<li>
<a href="step01_loading.html">Step 1: Loading &amp; processing images</a><br>
</li>
<li>
<a href="step02_initial_cluster.html">Step 2: Initial clustering</a><br>
</li>
<li>
<a href="step03_refinement.html">Step 3: Refinement</a><br>
</li>
<li>
<a href="step04_manual_tweak.html">Step 4: Tweaks &amp; edits</a><br>
</li>
<li><a href="step05_visualization_export.html">Step 5: Visualizing &amp; exporting output</a></li>
</ul>
<blockquote>
<p>You can also tour the functions in the <a href="https://hiweller.rbind.io/post/function-gallery-for-recolorize/" class="external-link">function gallery</a>.</p>
</blockquote>
<p><img src="Introduction_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"> The <code>recolorize</code> package is a toolbox for making color maps, essentially color-based image segmentation, using a combination of automatic, semi-automatic, and manual procedures. It has four major goals:</p>
<ol style="list-style-type: decimal">
<li><p>Provide a middle ground between automatic segmentation methods (which are hard to modify when they don’t work well) and manual methods (which can be slow and subjective).</p></li>
<li><p>Be deterministic whenever possible, so that you always get the same results from the same code.</p></li>
<li><p>Be modular and modifiable, so that you can tailor it for your purposes.</p></li>
<li><p>Play nice with other color analysis tools.</p></li>
</ol>
<p>The color map above, for example, was generated using a single function which runs in a few seconds (and is deterministic):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hiweller.github.io/recolorize/">recolorize</a></span><span class="op">)</span>

<span class="co"># get the path to the image (comes with the package, so we use system.file):</span>
<span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/corbetti.png"</span>, package <span class="op">=</span> <span class="st">"recolorize"</span><span class="op">)</span>

<span class="co"># fit a color map (only provided parameter is a color similarity cutoff)</span>
<span class="va">recolorize_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recolorize2.html">recolorize2</a></span><span class="op">(</span><span class="va">img</span>, cutoff <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></code></pre></div>
<p>Notice what we didn’t have to input: we didn’t have to declare how many colors we expected (5), what we expect those colors to be (red, green, blue, black, and white), which pixels to include in each color patch, or where the boundaries of those patches are.</p>
<p>This introduction is intended to get you up and running with the <code>recolorize</code> package. Ideally, after reading it, you will have enough information to start to play around with the set of tools that it provides in a way that suits what you need it to do.</p>
<p>I have tried not to assume too much about the reader’s background knowledge and needs, except that you are willing to use R and you have a color segmentation problem you have to solve before you can do something interesting with images. I primarily work with images of animals (beetles, fish, lizards, butterflies, snakes, birds, etc), and that will probably come through in the documentation. But it should work just as well for other kinds of images. Maybe better!</p>
<p>I hope that this package will be helpful to you, and that if it is, you will share it with others who might find it helpful too. I had a lot of fun discussions with a lot of interesting people while I was making it, for which I’m very grateful.</p>
<p>If something is unclear or you find a bug, please get in touch or <a href="https://github.com/hiweller/recolorize/issues" class="external-link">file an issue on the GitHub page</a>. Suggestions for improvements are always welcome!</p>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<blockquote>
<p>The bare minimum to start toying around with the package.</p>
</blockquote>
<p>The basic <code>recolorize</code> workflow is initial clustering step -&gt; refinement step -&gt; manual tweaks.</p>
<ol style="list-style-type: decimal">
<li><p>Images should first be color-corrected and have any background masked out, ideally with transparency, as in the image above, for example (<em>Chrysochroa corbetti</em>, taken by <a href="https://www.thelordlab.com/" class="external-link">Nathan P. Lord</a>, used with permission and egregiously downsampled to ~250x150 pixels by me).</p></li>
<li><p>In the initial clustering step, we bin all of the pixels into a smaller number of clusters, but still more than we expect to end up with at the end. In this case, we’ll end up with 8 clusters (<span class="math inline">\(2^3\)</span>):</p></li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">init_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recolorize.html">recolorize</a></span><span class="op">(</span><span class="va">img</span>, method <span class="op">=</span> <span class="st">"hist"</span>, bins <span class="op">=</span> <span class="fl">2</span>, 
                       color_space <span class="op">=</span> <span class="st">"sRGB"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Using 2^3 = 8 total bins</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto;"></p>
<ol start="3" style="list-style-type: decimal">
<li>Followed by a refinement step where we combine clusters by their similarity:</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">refined_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recluster.html">recluster</a></span><span class="op">(</span><span class="va">init_fit</span>, cutoff <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-5-1.png" width="384" style="display: block; margin: auto;"><img src="Introduction_files/figure-html/unnamed-chunk-5-2.png" width="384" style="display: block; margin: auto;"></p>
<p>The <code>recolorize2</code> function above calls these functions in sequence, since they tend to be pretty effective in combination.</p>
<ol start="4" style="list-style-type: decimal">
<li>Finally, we can do manual refinements to clean up the different color layers, for example performing simple morphological operations on individual layers:</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">final_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editLayer.html">editLayer</a></span><span class="op">(</span><span class="va">refined_fit</span>, <span class="fl">3</span>,
                        operation <span class="op">=</span> <span class="st">"fill"</span>, px_size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;"></p>
<ol start="5" style="list-style-type: decimal">
<li>Once you have a color map you’re happy with, you can export to a variety of formats. For instance, if I wanted to run Endler’s <a href="https://rdrr.io/cran/pavo/man/adjacent.html" class="external-link">adjacency and boundary strength analysis</a> in the <code>pavo</code> package, using human perception:</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recolorize_adjacency.html">recolorize_adjacency</a></span><span class="op">(</span><span class="va">final_fit</span>, coldist <span class="op">=</span> <span class="st">"default"</span>, hsl <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span>
<span class="co">#&gt; Warning: no DISPLAY variable so Tk is not available</span>
<span class="co">#&gt; Using single set of coldists for all images.</span>
<span class="co">#&gt; Using single set of hsl values for all images.</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">adj</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"m_dL|m_dS"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">adj</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># just print the chromatic and achromatic boundary strength values</span>
<span class="co">#&gt;      m_dS     m_dL</span>
<span class="co">#&gt;  40.59881 40.27214</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="batch-processing">Batch processing<a class="anchor" aria-label="anchor" href="#batch-processing"></a>
</h2>
<p>You can also batch process images using the same parameters, although <code>recolorize</code> functions only deal with one image at a time, so you will have to use a for loop or define a new function to call the appropriate functions in the right order:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get all 5 beetle images:</span>
<span class="va">images</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"recolorize"</span><span class="op">)</span>, <span class="st">"png"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># make an empty list to store the results:</span>
<span class="va">rc_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">images</span><span class="op">)</span><span class="op">)</span>

<span class="co"># run `recolorize2` on each image</span>
<span class="co"># you would probably want to add more sophisticated steps in here as well, but you get the idea</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">images</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">rc_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/recolorize2.html">recolorize2</a></span><span class="op">(</span><span class="va">images</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, bins <span class="op">=</span> <span class="fl">2</span>, 
                              cutoff <span class="op">=</span> <span class="fl">30</span>, plotting <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># plot for comparison:</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">rc_list</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/plotImageArray.html">plotImageArray</a></span><span class="op">(</span><span class="va">i</span><span class="op">$</span><span class="va">original_img</span><span class="op">)</span>
  <span class="fu"><a href="../reference/plotImageArray.html">plotImageArray</a></span><span class="op">(</span><span class="fu"><a href="../reference/recoloredImage.html">recoloredImage</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-8-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># given the variety of colors in the dataset, not too bad, </span>
<span class="co"># although you might go in and refine these individually</span>

<span class="co"># and clean up our working space a bit</span>
<span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">rc_list</span><span class="op">)</span></code></pre></div>
<p>The <code>recolorize</code> package mostly works internally with objects of class <code>recolorize</code>, which contains a few different elements that are worth understanding as you work through the rest of the documentation (linked at the bottom).</p>
<div class="section level3">
<h3 id="the-recolorize-class">The <code>recolorize</code> class<a class="anchor" aria-label="anchor" href="#the-recolorize-class"></a>
</h3>
<p>Objects of S3 class <code>recolorize</code> are lists with several elements:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">final_fit</span><span class="op">)</span>
<span class="co">#&gt; $names</span>
<span class="co">#&gt; [1] "original_img"      "pixel_assignments" "sizes"            </span>
<span class="co">#&gt; [4] "centers"           "call"              "recolored_img"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] "recolorize"</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p><code>original_img</code> is a a <code>raster</code> matrix, essentially a matrix of hex color codes. This is a more lightweight version of the typical 3D/4D color image array, and can be plotted easily by running <code>plot(final_fit$original_img)</code>.</p></li>
<li><p><code>centers</code> is a matrix of RGB centers (0-1 range) for each of the color patches. Their order matches the index values in the <code>pixel_assignments</code> matrix, and can be plotted as a color bar using <code>plotColorPalette(final_fit$centers)</code>.</p></li>
<li><p><code>sizes</code> is a vector of patch sizes, whose order matches the row order of <code>centers</code>.</p></li>
<li><p><code>pixel_assignments</code> is a paint-by-numbers matrix, where each pixel is coded as the color center to which it was assigned. For example, cells with a <code>1</code> have been assigned to the color represented by row 1 of <code>centers</code>. Background pixels are marked as 0.</p></li>
<li><p><code>call</code> is the set of operations that was applied to this recolorize object:</p></li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">final_fit</span><span class="op">$</span><span class="va">call</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; recolorize(img = img, method = "hist", bins = 2, color_space = "sRGB")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; recluster(recolorize_obj = init_fit, cutoff = 45)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; editLayer(recolorize_obj = refined_fit, layer_idx = 3, operation = "fill", </span>
<span class="co">#&gt;     px_size = 4)</span></code></pre></div>
<p>Every time you modify a <code>recolorize</code> object, the new modification is appended as the next item down on this list, so that you can recreate exactly what you did to make a given color map.</p>
<p>If you plot the whole <code>recolorize</code> object, you’ll get back the plot you see above: the original image, the color map (where each pixel has been recolored), and the color palette. You can also plot each of these individually:</p>
<p>You can get the recolored image by calling <code>recoloredImage</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># type = raster gets you a raster (like original_img); type = array gets you an </span>
<span class="co"># image array</span>
<span class="va">recolored_img</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recoloredImage.html">recoloredImage</a></span><span class="op">(</span><span class="va">final_fit</span>, type <span class="op">=</span> <span class="st">"array"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotImageArray.html">plotImageArray</a></span><span class="op">(</span><span class="va">recolored_img</span><span class="op">)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-11-1.png" width="192" style="display: block; margin: auto;"></p>
<p><code>recoloredImage</code> is just a shortcut function for <code>constructImage</code>, which lets you decide which colors to assign to each category in case you want to swap out the palette:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"navy"</span>, <span class="st">"lightblue"</span>, <span class="st">"blueviolet"</span>,
            <span class="st">"turquoise"</span>, <span class="st">"slateblue"</span>, <span class="st">"royalblue"</span>, 
            <span class="st">"aquamarine"</span>, <span class="st">"dodgerblue"</span><span class="op">)</span>
<span class="va">blue_beetle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/constructImage.html">constructImage</a></span><span class="op">(</span><span class="va">final_fit</span><span class="op">$</span><span class="va">pixel_assignments</span>, 
               centers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/col2rgb.html" class="external-link">col2rgb</a></span><span class="op">(</span><span class="va">colors</span><span class="op">)</span> <span class="op">/</span> <span class="fl">255</span><span class="op">)</span><span class="op">)</span>

<span class="co"># a very blue beetle indeed:</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotImageArray.html">plotImageArray</a></span><span class="op">(</span><span class="va">blue_beetle</span><span class="op">)</span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-12-1.png" width="192" style="display: block; margin: auto;"></p>
<p>This should give you a good idea of how this package works, what it’s capable of doing, and the different modular components that go into its structure. This is more of a toolbox than a single method, so you will almost certainly not need all of these options. If you’d like to learn more, I would recommend reading through the vignettes linked above (in order) on each of the steps and messing around with your own images. And check the GitHub (<a href="https://github.com/hiweller/recolorize" class="external-link uri">https://github.com/hiweller/recolorize</a>) for links out to examples using real data!</p>
</div>
</div>
<div class="section level2">
<h2 id="general-guidelines">General guidelines<a class="anchor" aria-label="anchor" href="#general-guidelines"></a>
</h2>
<div class="section level3">
<h3 id="this-is-a-lot-of-options--how-do-i-choose-a-procedure">This is a lot of options. How do I choose a procedure?<a class="anchor" aria-label="anchor" href="#this-is-a-lot-of-options--how-do-i-choose-a-procedure"></a>
</h3>
<p>Recolorize is a toolbox, not a single algorithm. Most things will more or less work; if it looks reasonable, it is. Keep in mind that there is a big difference between getting slightly different color maps and getting qualitatively different results. Keep your final goal in mind. You can also try lots of different things and see if it makes a real difference.</p>
<p>I wish I could write a single function that would do all of these steps in the correct sequence and produce perfect results; the reason that function does not exist is because I find I have to experiment a fair amount with every image set, and I often end up with a different order of operations depending on the problem.</p>
<p>Start with <code>recolorize2</code> and identify the common problems you’re encountering. Does it make sense to batch process all of your images, then refine them individually? Is it better to choose a different cutoff for each image? Luckily, these functions are relatively fast, so you can test out different options.</p>
<p>You can also get way fancier with cutoffs than I have here. This package is built on some pretty simple scaffolding: you get a starting set of clusters, then you modify them. If you have a better/more refined way of deciding which colors to cluster, then go for it. I will soon be adding some example workflows from collaborators which should be helpful.</p>
<p>There is another very tempting option: make a small training set of nice color maps manually with recolorize, then use those to either fit a statistical model for other fits or use machine learning to do the rest. I think this is a really compelling idea; I just haven’t tested it yet. Maybe you want to try it out?</p>
</div>
<div class="section level3">
<h3 id="can-you-define-an-optimality-condition-to-do-all-the-segmentation-automatically">Can you define an optimality condition to do all the segmentation automatically?<a class="anchor" aria-label="anchor" href="#can-you-define-an-optimality-condition-to-do-all-the-segmentation-automatically"></a>
</h3>
<p>As far as I can tell, no. This is because of the problem I pointed out at the beginning: the ‘correct’ segmentation depends on your particular question more than anything else.</p>
</div>
<div class="section level3">
<h3 id="what-about-batch-processing">What about batch processing?<a class="anchor" aria-label="anchor" href="#what-about-batch-processing"></a>
</h3>
<p>Every function in this package operates on a single image at a time. This is because there is so much variation in how people go about batch processing anything: if I tried to impose what I considered to be a useful batch processing structure, within a few months I would find that it was too inflexible for some new project structure someone else needed to use it for. So, instead, the idea is that you can write your own batch processing functions or for loops as needed to suit your data structure. Or maybe you come up with something better than I can think of, in which case, please let me add it to the package and add you as an author!</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hannah Weller.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
