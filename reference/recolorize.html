<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simplify the colors of an image — recolorize • recolorize</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simplify the colors of an image — recolorize"><meta property="og:description" content="Clusters the colors in an RGB image according to a specified method,
then recolors that image to the simplified color scheme."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">recolorize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/step00_prep.html">Step 0: Image acquisition and preparation</a>
    </li>
    <li>
      <a href="../articles/step01_loading.html">Step 1: Loading &amp; processing images</a>
    </li>
    <li>
      <a href="../articles/step02_initial_cluster.html">Step 2: Initial clustering</a>
    </li>
    <li>
      <a href="../articles/step03_refinement.html">Step 3: Refinement</a>
    </li>
    <li>
      <a href="../articles/step04_manual_tweak.html">Step 4: Tweaks &amp; edits</a>
    </li>
    <li>
      <a href="../articles/step05_visualization_export.html">Step 5: Exporting &amp; visualizing output</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simplify the colors of an image</h1>
    
    <div class="hidden name"><code>recolorize.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Clusters the colors in an RGB image according to a specified method,
then recolors that image to the simplified color scheme.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">recolorize</span><span class="op">(</span>
  <span class="va">img</span>,
  method <span class="op">=</span> <span class="st">"histogram"</span>,
  bins <span class="op">=</span> <span class="fl">2</span>,
  n <span class="op">=</span> <span class="fl">5</span>,
  color_space <span class="op">=</span> <span class="st">"sRGB"</span>,
  ref_white <span class="op">=</span> <span class="st">"D65"</span>,
  lower <span class="op">=</span> <span class="cn">NULL</span>,
  upper <span class="op">=</span> <span class="cn">NULL</span>,
  transparent <span class="op">=</span> <span class="cn">TRUE</span>,
  resid <span class="op">=</span> <span class="cn">FALSE</span>,
  resize <span class="op">=</span> <span class="cn">NULL</span>,
  rotate <span class="op">=</span> <span class="cn">NULL</span>,
  plotting <span class="op">=</span> <span class="cn">TRUE</span>,
  horiz <span class="op">=</span> <span class="cn">TRUE</span>,
  cex_text <span class="op">=</span> <span class="fl">1.5</span>,
  scale_palette <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>img</dt>
<dd><p>Path to the image (a character vector) or a 3D image array as read
in by <code><a href="https://rdrr.io/pkg/png/man/readPNG.html" class="external-link">readPNG</a></code> <code>{readImage}</code>.</p></dd>
<dt>method</dt>
<dd><p>Method for clustering image colors. One of either <code>histogram</code>
or <code>kmeans</code>. See details.</p></dd>
<dt>bins</dt>
<dd><p>If <code>method = "histogram"</code>, either the number of bins per color
channel (if a single number is provided) OR a vector of length 3 with the
number of bins for each channel.</p></dd>
<dt>n</dt>
<dd><p>If <code>method = "kmeans"</code>, the number of color clusters to fit.</p></dd>
<dt>color_space</dt>
<dd><p>Color space in which to minimize distances, passed to
<code><a href="https://rdrr.io/r/grDevices/grDevices-package.html" class="external-link">grDevices</a>{convertColor}</code>. One of "sRGB", "Lab", or "Luv".
Default is "Lab", a perceptually uniform (for humans) color space.</p></dd>
<dt>ref_white</dt>
<dd><p>Reference white for converting to different color spaces.
D65 (the default) corresponds to standard daylight.</p></dd>
<dt>lower, upper</dt>
<dd><p>RGB triplet ranges for setting a bounding box of pixels to
mask. See details.</p></dd>
<dt>transparent</dt>
<dd><p>Logical. Treat transparent pixels as background? Requires
an alpha channel (PNG).</p></dd>
<dt>resid</dt>
<dd><p>Logical. Return a list of different residual metrics to
describe the goodness of fit?</p></dd>
<dt>resize</dt>
<dd><p>A value between 0 and 1 for resizing the image (ex. <code>resize = 0.5</code> will reduce image size by 50%). Recommended for large images as it can
speed up analysis considerably. See details.</p></dd>
<dt>rotate</dt>
<dd><p>Degrees to rotate the image clockwise.</p></dd>
<dt>plotting</dt>
<dd><p>Logical. Plot recolored image &amp; color palette?</p></dd>
<dt>horiz</dt>
<dd><p>Logical for plotting. Plot output image and color palette side
by side (<code>TRUE</code>) or stacked vertically (<code>FALSE</code>)?</p></dd>
<dt>cex_text</dt>
<dd><p>If <code>plotting = TRUE</code> and <code>scale_palette = FALSE</code>, size of
text to display on the color palette numbers.</p></dd>
<dt>scale_palette</dt>
<dd><p>Logical. If plotting, plot colors in the color palette
proportional to the size of each cluster?</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of S3 class <code>recolorize</code> with the following attributes:</p><ol><li><p><code>original_img</code>: The original image, as a raster array.</p></li>
<li><p><code>centers</code>: A matrix of color centers in RGB (0-1 range).</p></li>
<li><p><code>sizes</code>: The number of pixels assigned to each color cluster.</p></li>
<li><p><code>pixel_assignments</code>: A matrix of color center assignments for each
pixel.</p></li>
<li><p><code>call</code>: The call(s) used to generate the <code>recolorize</code> object.</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p>Method for color clustering: <code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></code> clustering tries to
find the set of <code>n</code> clusters that minimize overall distances. Histogram
binning divides up color space according to set breaks; for example, bins = 2
would divide the red, green, and blue channels into 2 bins each (&gt; 0.5 and &lt;
0 .5), resulting in 8 possible ranges. A white pixel (RGB = 1, 1, 1) would
fall into the R &gt; 0.5, G &gt; 0.5, B &gt; 0.5 bin. The resulting centers represent
the average color of all the pixels assigned to that bin.</p>
<p>K-means clustering can produce more intuitive results, but because it is
iterative, it will find slightly different clusters each time it is run, and
their order will be arbitrary. It also tends to divide up similar colors that
make up the majority of the image. Histogram binning will produce the same
results every time, in the same order, and because it forces the bins to be
dispersed throughout color space, tends to better pick up small color
details. Bins are also comparable across images. However, this sometimes
means returning empty bins (i.e. the white bin will be empty if clustering a
very dark image).</p>
<p>Background masking: <code>lower</code>, <code>upper</code>, and <code>transparent</code> are all background
masking conditions. Transparency is unambiguous and so tends to produce
cleaner results, but the <code>lower</code> and <code>upper</code> bounds can be used instead to
treat pixels in a specific color range as the background. For example, to
ignore white pixels (RGB = 1, 1, 1), you might want to mask all pixels whose
R, G, and B values exceed 0.9. In that case, <code>lower = c(0.9, 0.9, 0.9)</code> and
<code>upper = c(1, 1, 1)</code>. Regardless of input background, recolored images are
returned with transparent backgrounds by adding an alpha channel if one does
not already exist.</p>
<p>Resizing: The speed benefits of downsizing images are fairly obvious (fewer
pixels = fewer operations). Because recoloring the images simplifies their
detail anyways, downsizing prior to recoloring doesn't run a very high risk
of losing important information. A general guideline for resizing is that
any distinguishable features of interest should still take up at least 2
pixels (preferably with a margin of error) in the resized image.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># filepath to image</span></span>
<span class="r-in"><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/chongi.png"</span>, package <span class="op">=</span> <span class="st">"recolorize"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># default: histogram, 2 bins/channel</span></span>
<span class="r-in"><span class="va">rc</span> <span class="op">&lt;-</span> <span class="fu">recolorize</span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 2^3 = 8 total bins</span>
<span class="r-plt img"><img src="recolorize-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># we can also have different numbers of bins per channel</span></span>
<span class="r-in"><span class="va">rc</span> <span class="op">&lt;-</span> <span class="fu">recolorize</span><span class="op">(</span><span class="va">img</span>, bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># mostly red</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 4*1*1 = 4 bins</span>
<span class="r-plt img"><img src="recolorize-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="va">rc</span> <span class="op">&lt;-</span> <span class="fu">recolorize</span><span class="op">(</span><span class="va">img</span>, bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># mostly green</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 1*4*1 = 4 bins</span>
<span class="r-plt img"><img src="recolorize-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="va">rc</span> <span class="op">&lt;-</span> <span class="fu">recolorize</span><span class="op">(</span><span class="va">img</span>, bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># mostly blue</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 1*1*4 = 4 bins</span>
<span class="r-plt img"><img src="recolorize-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># kmeans can produce a better fit with fewer colors</span></span>
<span class="r-in"><span class="va">rc</span> <span class="op">&lt;-</span> <span class="fu">recolorize</span><span class="op">(</span><span class="va">img</span>, method <span class="op">=</span> <span class="st">"kmeans"</span>, n <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span class="r-plt img"><img src="recolorize-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># increasing numbers of kmean colors</span></span>
<span class="r-in"><span class="va">recolored_images</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, length <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="va">kmeans_recolor</span> <span class="op">&lt;-</span> <span class="fu">recolorize</span><span class="op">(</span><span class="va">img</span>, method <span class="op">=</span> <span class="st">"kmeans"</span>,</span>
<span class="r-in">                               n <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-plt img"><img src="recolorize-6.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="recolorize-7.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="recolorize-8.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="recolorize-9.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="recolorize-10.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="recolorize-11.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="recolorize-12.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="recolorize-13.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="recolorize-14.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="recolorize-15.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># kmeans, 10 colors</span></span>
<span class="r-in"><span class="va">kmeans_recolor</span> <span class="op">&lt;-</span> <span class="fu">recolorize</span><span class="op">(</span><span class="va">img</span>, method <span class="op">=</span> <span class="st">"kmeans"</span>,</span>
<span class="r-in">                             n <span class="op">=</span> <span class="fl">8</span>, plotting <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">hist_recolor</span> <span class="op">&lt;-</span> <span class="fu">recolorize</span><span class="op">(</span><span class="va">img</span>, method <span class="op">=</span> <span class="st">"hist"</span>,</span>
<span class="r-in">                           bins <span class="op">=</span> <span class="fl">2</span>, plotting <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 2^3 = 8 total bins</span>
<span class="r-in"><span class="co"># to reset graphical parameters:</span></span>
<span class="r-in"><span class="va">current_par</span> <span class="op">&lt;-</span> <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># compare binning vs. kmeans clustering</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kmeans_recolor</span><span class="op">$</span><span class="va">original_img</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"original"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="recoloredImage.html">recoloredImage</a></span><span class="op">(</span><span class="va">kmeans_recolor</span>, type <span class="op">=</span> <span class="st">"raster"</span><span class="op">)</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"kmeans"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="recoloredImage.html">recoloredImage</a></span><span class="op">(</span><span class="va">hist_recolor</span>, type <span class="op">=</span> <span class="st">"raster"</span><span class="op">)</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"binning"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="recolorize-16.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">current_par</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hannah Weller.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

